{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "API Gateway REST API for CRUD operations",
    "Resources": {
      "ApiGatewayRestApi": {
        "Type": "AWS::ApiGateway::RestApi",
        "Properties": {
          "Name": "mycrudapi"
        }
      },
      "ApiGatewayResourceItems": {
        "Type": "AWS::ApiGateway::Resource",
        "Properties": {
          "RestApiId": { "Ref": "ApiGatewayRestApi" },
          "ParentId": { "Fn::GetAtt": [ "ApiGatewayRestApi", "RootResourceId" ] },
          "PathPart": "items"
        }
      },
      "ApiGatewayMethodItemsGet": {
        "Type": "AWS::ApiGateway::Method",
        "Properties": {
          "RestApiId": { "Ref": "ApiGatewayRestApi" },
          "ResourceId": { "Ref": "ApiGatewayResourceItems" },
          "HttpMethod": "GET",
          "AuthorizationType": "NONE",
          "Integration": {
            "IntegrationHttpMethod": "POST",
            "Type": "AWS_PROXY",
            "Uri": {
              "Fn::Sub": "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${CrudLambdaFunction.Arn}/invocations"
            }
          }
        }
      },
      "ApiGatewayMethodItemsPost": {
        "Type": "AWS::ApiGateway::Method",
        "Properties": {
          "RestApiId": { "Ref": "ApiGatewayRestApi" },
          "ResourceId": { "Ref": "ApiGatewayResourceItems" },
          "HttpMethod": "POST",
          "AuthorizationType": "NONE",
          "Integration": {
            "IntegrationHttpMethod": "POST",
            "Type": "AWS_PROXY",
            "Uri": {
              "Fn::Sub": "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${CrudLambdaFunction.Arn}/invocations"
            }
          }
        }
      },
      "ApiGatewayMethodItemGet": {
        "Type": "AWS::ApiGateway::Method",
        "Properties": {
          "RestApiId": { "Ref": "ApiGatewayRestApi" },
          "ResourceId": { "Ref": "ApiGatewayResourceItems" },
          "HttpMethod": "GET",
          "AuthorizationType": "NONE",
          "RequestParameters": {
            "method.request.path.id": true
          },
          "Integration": {
            "IntegrationHttpMethod": "POST",
            "Type": "AWS_PROXY",
            "Uri": {
              "Fn::Sub": "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${CrudLambdaFunction.Arn}/invocations"
            }
          }
        }
      },
      "ApiGatewayMethodItemPut": {
        "Type": "AWS::ApiGateway::Method",
        "Properties": {
          "RestApiId": { "Ref": "ApiGatewayRestApi" },
          "ResourceId": { "Ref": "ApiGatewayResourceItems" },
          "HttpMethod": "PUT",
          "AuthorizationType": "NONE",
          "RequestParameters": {
            "method.request.path.id": true
          },
          "Integration": {
            "IntegrationHttpMethod": "POST",
            "Type": "AWS_PROXY",
            "Uri": {
              "Fn::Sub": "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${CrudLambdaFunction.Arn}/invocations"
            }
          }
        }
      },
      "ApiGatewayMethodItemDelete": {
        "Type": "AWS::ApiGateway::Method",
        "Properties": {
          "RestApiId": { "Ref": "ApiGatewayRestApi" },
          "ResourceId": { "Ref": "ApiGatewayResourceItems" },
          "HttpMethod": "DELETE",
          "AuthorizationType": "NONE",
          "RequestParameters": {
            "method.request.path.id": true
          },
          "Integration": {
            "IntegrationHttpMethod": "POST",
            "Type": "AWS_PROXY",
            "Uri": {
              "Fn::Sub": "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${CrudLambdaFunction.Arn}/invocations"
            }
          }
        }
      }
    },
    "Outputs": {
      "ApiUrl": {
        "Value": {
          "Fn::Sub": "https://${ApiGatewayRestApi}.execute-api.${AWS::Region}.amazonaws.com/prod/items"
        }
      }
    }
  }